| {% block head %}
link(rel="stylesheet", href="//releases.flowplayer.org/6.0.3/skin/functional.css")
| {% endblock %}

| {% block body %}

#node-container
	section.node-preview.video
		#flowplayer_container.is-splash(
			style="{% if node.picture %}background-image:url({{node.picture.thumbnail('l')}}); background-repeat:no-repeat; {% endif %}")

	section.node-details-container

		.node-details-header
			.node-title
				| {{node.name}}

		.node-details-description
			| {{node.description|safe}}

		.node-details-meta

			ul.node-details-meta-list
				li.node-details-meta-list-item.status
						| {{node.properties.status}}

				li.node-details-meta-list-item.date
					| {{ node._created }}

				li.btn-group.node-details-meta-list-item.video.download
					button.btn.btn-default.dropdown-toggle(
						type="button",
						data-toggle="dropdown",
						aria-haspopup="true",
						aria-expanded="false")
						| Download
						i.ion-ios-arrow-down.icon-dropdown-menu

					ul.dropdown-menu
						| {% for child in node.file_children._items %}
						li
							a(href="{{ child.link }}",
								title="Download this video format")
								span.length {{ child.length | filesizeformat }}

								span.format {{ child.format }}
								span.size {{ child.size }}

						| {% endfor %}

		#comments-container
			#comments-list-items-loading
				i.ion-load-c


| {% endblock %}

| {% block footer_scripts %}

script(type="text/javascript").
	var container = document.getElementById("flowplayer_container");

	flowplayer(container, {
		key: "{{config.FLOWPLAYER_KEY}}",
		splash: true,
			clip: {
				sources: {{ node.video_sources | safe }}
			}
	});

	var url = "{{url_for('nodes.comments_index')}}?parent_id={{node._id}}"
	$.get(url, function(dataHtml) {
		// Update the DOM injecting the generate HTML into the page
		$('#comments-container').replaceWith(dataHtml);
	})

| {% endblock %}
